(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{543:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"校内远程桌面使用指北"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#校内远程桌面使用指北"}},[t._v("#")]),t._v(" 校内远程桌面使用指北")]),t._v(" "),a("p",[t._v("by "),a("a",{attrs:{href:"https://github.com/jerrylususu",target:"_blank",rel:"noopener noreferrer"}},[t._v("@jerrylususu"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("本文写于2020年12月。")])]),t._v(" "),a("h2",{attrs:{id:"远程桌面是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程桌面是什么"}},[t._v("#")]),t._v(" 远程桌面是什么？")]),t._v(" "),a("p",[t._v("远程桌面，是一种远程访问技术，可以从其他设备连接到你的电脑，并访问所有应用、文件和资源，就像坐在自己的电脑前一样。简而言之，这是一项可以把不属于自己的设备当成自己的设备使用的技术。")]),t._v(" "),a("p",[t._v("作为一项技术，远程桌面有不同的实现。在 Windows 环境下，最常见的远程桌面实现为 Remote Desktop Protocol （RDP，远程桌面协议），Windows 为其提供了完善的支持。在 Linux 环境下，最常见的远程桌面实现为 Virtual Network Computing （VNC）。其他厂家也有自己的远程桌面实现，如 TeamViewer, AnyDesk, ToDesk, 向日葵, 甚至于 QQ 的「远程协助」。本文将着眼于 Windows 环境下 RDP 的配置，这也是校内最常见的用例。（若需要从 iPad 端远程控制 Windows，可以直接在 App store 中搜索安装 RD Client，最新版本支持完整的鼠标操作。若需要从 Windows 端远程控制 Mac，除了 Mac 提供的 VNC 之外，推荐使用流畅性更高的第三方软件，例如 NoMachine 等。）")]),t._v(" "),a("h2",{attrs:{id:"远程桌面的典型使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程桌面的典型使用场景"}},[t._v("#")]),t._v(" 远程桌面的典型使用场景")]),t._v(" "),a("ul",[a("li",[t._v("购买了重量较重的游戏本或不便于携带的台式机在宿舍，但是想从图书馆、实验室等位置使用。")]),t._v(" "),a("li",[t._v("在参加计算机系的实验课程时，使用宿舍或实验室内性能强大的设备进行编译操作，而不必被机房性能羸弱的电脑限制。")]),t._v(" "),a("li",[t._v("在图书馆专心复习时，仍能访问宿舍电脑上存储的课件、笔记、电子书等资料。")]),t._v(" "),a("li",[t._v("在教室 Pre 的时候发现自己忘了携带所需的资料，可以使用远程桌面从宿舍电脑上取回。")]),t._v(" "),a("li",[t._v("在校内有 WiFi 信号覆盖的位置使用远程桌面连接回宿舍电脑继续工作/学习，而无需手动维持不同设备（如笔记本和台式机）间的数据同步状态。")]),t._v(" "),a("li",[t._v("在宿舍床上使用 iPad 等平板类设备游玩床下电脑中的 Galgame。")])]),t._v(" "),a("h2",{attrs:{id:"不建议使用远程桌面的场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不建议使用远程桌面的场景"}},[t._v("#")]),t._v(" 不建议使用远程桌面的场景")]),t._v(" "),a("ul",[a("li",[t._v("玩大型游戏、看电影/视频（RDP 主要为日常工作使用优化，变化频繁的画面使用 Steam Remote Play 等技术更适合）")]),t._v(" "),a("li",[t._v("复制体积较大的文件（RDP 对在不同设备间转移小文件十分合适，但文件体积过大可能造成网络阻塞，操作卡死）")])]),t._v(" "),a("blockquote",[a("p",[t._v("下称自己的设备为「服务端」，机房/教室/图书馆等的设备为「客户端」")])]),t._v(" "),a("h2",{attrs:{id:"服务端配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端配置"}},[t._v("#")]),t._v(" 服务端配置")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://support.microsoft.com/zh-cn/windows/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2-5fe128d5-8fb1-7a23-3b8a-41e636865e8c",target:"_blank",rel:"noopener noreferrer"}},[t._v("开启「远程桌面」功能。"),a("OutboundLink")],1),t._v("（此功能需要专业版本 Windows，家庭版本可以使用 GitHub 上的开源工具 "),a("a",{attrs:{href:"https://github.com/stascorp/rdpwrap",target:"_blank",rel:"noopener noreferrer"}},[t._v("RDPWrap"),a("OutboundLink")],1),t._v(" 开启此功能，"),a("a",{attrs:{href:"https://www.iplaysoft.com/rdp-wrapper-library.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("教程"),a("OutboundLink")],1),t._v(")。注：若按照教程仍然无法开启功能，则可能是服务端‘rdpwrap.ini’文件与当前Windows版本不匹配，可以从 Github 的 Issues 或其他地方获取 rdpwrap 文件并替换。详情可参考此"),a("a",{attrs:{href:"https://b23.tv/TTaRTD",target:"_blank",rel:"noopener noreferrer"}},[t._v("B站视频演示"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/windows-server/remote/remote-desktop-services/clients/change-listening-port",target:"_blank",rel:"noopener noreferrer"}},[t._v("设置远程桌面端口为非 3389 端口"),a("OutboundLink")],1),t._v(" ，并记住这个端口号（此为信息中心的限制，为防止病毒通过远程桌面传播，默认阻断了 3389 端口上的 TCP 链接）")]),t._v(" "),a("li",[t._v("查看并记录自己的 IP 地址：打开「任务管理器」，切换到「性能」标签页，在左侧找到「Wi-Fi」，在右侧找到「IPv4 地址」并记录。（通常为以小数点分割的一组数字，如 "),a("code",[t._v("10.XX.XX.XX")]),t._v("）")]),t._v(" "),a("li",[t._v("（非必需设置）如果想从非校园网络访问远程设备，可以尝试使用 "),a("a",{attrs:{href:"https://www.zerotier.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ZeroTier One"),a("OutboundLink")],1),t._v(" 等软件"),a("a",{attrs:{href:"https://b23.tv/MzHzMi",target:"_blank",rel:"noopener noreferrer"}},[t._v("配置内网穿透"),a("OutboundLink")],1),t._v("功能。")])]),t._v(" "),a("h2",{attrs:{id:"从客户端连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从客户端连接"}},[t._v("#")]),t._v(" 从客户端连接")]),t._v(" "),a("ol",[a("li",[t._v("在「开始」菜单中选择「Windows 附件 / 远程桌面」（或使用 "),a("code",[t._v("Win+R")]),t._v(" 打开「运行」窗口，然后输入 "),a("code",[t._v("mstsc")]),t._v("，按下回车）")]),t._v(" "),a("li",[t._v("在「计算机」文本框中输入自己的 IP 和端口号，用英文冒号分割。（例："),a("code",[t._v("10.XX.XX.XX:YYYY")]),t._v("）")]),t._v(" "),a("li",[t._v("点击「连接」按钮")]),t._v(" "),a("li",[t._v("在弹出的认证窗口中输入自己的用户名和密码（如果服务端使用的是微软账户，需要输入微软账户的邮箱和密码）")]),t._v(" "),a("li",[t._v("在证书确认窗口点击「是」")]),t._v(" "),a("li",[t._v("如果一切正常，应该能见到远程设备的桌面了。")])]),t._v(" "),a("h3",{attrs:{id:"用于在校内网通过邮箱获取服务端ip地址的python脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用于在校内网通过邮箱获取服务端ip地址的python脚本"}},[t._v("#")]),t._v(" 用于在校内网通过邮箱获取服务端IP地址的"),a("code",[t._v("python")]),t._v("脚本:")]),t._v(" "),a("p",[t._v("by "),a("a",{attrs:{href:"https://github.com/KagaJiankui",target:"_blank",rel:"noopener noreferrer"}},[t._v("@KagaJiankui"),a("OutboundLink")],1)]),t._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[t._v("获取IP的脚本")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# coding: utf-8")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" smtplib\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" datetime\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MIMEText\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("header "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Header\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" socket\n\n_local_ip "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),t._v("\n\nmail_info "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recv_address'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recv@example.sustech.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#你的接收端邮箱地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sender_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'send@example.sustech.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#你的发送端邮箱地址")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sender_pwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'authenticationcode'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#授权码（用于qq或163邮箱）")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_server'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp.example.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#smtp发送服务器（在邮箱帮助页面查看）")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'subject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'远程电脑IP信息已更新'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'content'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'您的校内网IP信息: {}'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send_message")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置发送邮件的内容")]),t._v("\n    msg "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MIMEText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plain'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'From'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sender_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Subject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'subject'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf-8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'To'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recv_address'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发送邮件")]),t._v("\n    smtp "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" smtplib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SMTP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    smtp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'smtp_server'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    smtp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sender_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sender_pwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    smtp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sendmail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'sender_name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mail_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'recv_address'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("msg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("as_string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        smtp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v(" smtplib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SMTPException "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        e "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Failed to close SMTP session."')]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_host_ip")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n    这个方法是目前见过最优雅获取本机服务器的IP方法了。没有任何的依赖，也没有去猜测机器上的网络设备信息。\n    而且是利用 UDP 协议来实现的，生成一个UDP包，把自己的 IP 放如到 UDP 协议头中，然后从UDP包中获取本机的IP。\n    这个方法并不会真实的向外部发包，所以用抓包工具是看不到的。但是会申请一个 UDP 的端口，所以如果经常调用也会比较耗时的，这里如果需要可以将查询到的IP给缓存起来，性能可以获得很大提升。\n    :return:\n    """')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("global")]),t._v(" _local_ip\n    s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" _local_ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" socket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("socket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("socket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AF_INET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" socket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SOCK_DGRAM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'8.8.8.8'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            _local_ip "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getsockname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" _local_ip\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mail_ip_send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip_real"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""\n    使用邮件发送IP地址.\n    """')]),t._v("\n    info_dict "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"校内网IP: "')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ip_real "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strftime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%Y-%m-%d %H:%M:%S %Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\n"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("info_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    send_message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("info_dict"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\nip_val "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_host_ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\nseconds_sleep "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检测IP地址的时间间隔")]),t._v("\nitr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3600")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" seconds_sleep  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# IP地址无变动时默认发送邮件的小时数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    ip_real "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_host_ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("datetime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hour\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip_real "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" ip_val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#晚上3点到早7点之间不发送IP")]),t._v("\n        mail_ip_send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip_real"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        ip_val "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ip_real\n    num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" itr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        mail_ip_send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip_real"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        ip_val "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ip_real\n        num "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seconds_sleep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("p",[t._v("本脚本要求"),a("code",[t._v("python>3.0")]),t._v("与对应的依赖.建议使用您的私人邮箱而非学校提供的邮箱作为收发端.在您的台式机或游戏本上直接运行脚本:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ python ./mailer.py "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#将文件保存为mailer.py")]),t._v("\n")])])]),a("p",[t._v("该脚本便会自动检测当前IP地址并发送到您指定的接收端邮箱中,若检测到IP地址变动或经过您指定的等待小时数,脚本即重复发送IP地址.直接运行脚本会占用一个命令行窗口.")]),t._v(" "),a("p",[t._v("当您的移动端设备与您的主机连接到同一局域网时,您可以使用这个IP地址与对应的端口号连接到您的远程桌面、SSH、Jupyter等应用的服务端.")]),t._v(" "),a("h2",{attrs:{id:"在图书馆使用远程桌面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在图书馆使用远程桌面"}},[t._v("#")]),t._v(" 在图书馆使用远程桌面")]),t._v(" "),a("p",[t._v("在南科大的三个图书馆中，都有公共的电脑区域，使用此区域的电脑作为远程桌面的客户端也是不错的选择。（笔者自测可以提升 50% ~ 200% 不等的工作/学习效率。）")]),t._v(" "),a("p",[t._v("不同图书馆间电脑对比如下表。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("图书馆")]),t._v(" "),a("th",[t._v("电脑设备数（约）")]),t._v(" "),a("th",[t._v("操作系统")]),t._v(" "),a("th",[t._v("屏幕分辨率")]),t._v(" "),a("th",[t._v("连接速度")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("琳恩")]),t._v(" "),a("td",[t._v("~50")]),t._v(" "),a("td",[t._v("Windows 7")]),t._v(" "),a("td",[t._v("1080p, 100% DPI")]),t._v(" "),a("td",[t._v("百兆")])]),t._v(" "),a("tr",[a("td",[t._v("一丹")]),t._v(" "),a("td",[t._v("~100")]),t._v(" "),a("td",[t._v("Windows 10")]),t._v(" "),a("td",[t._v("1080p, 125% DPI")]),t._v(" "),a("td",[t._v("千兆")])]),t._v(" "),a("tr",[a("td",[t._v("涵泳")]),t._v(" "),a("td",[t._v("~10")]),t._v(" "),a("td",[t._v("Windows 10")]),t._v(" "),a("td",[t._v("1080p, 125% DPI")]),t._v(" "),a("td",[t._v("千兆")])])])]),t._v(" "),a("p",[t._v("在图书馆使用远程桌面的时候，以下几点可以帮助你获得更好的体验：")]),t._v(" "),a("ol",[a("li",[t._v("如果觉得卡顿，可以在连接前在「体验」标签页中设置连接速度为 "),a("code",[t._v("WAN （10 Mbps 或更高速度，高延迟）")]),t._v(" ，并取消勾选「拖动时显示窗口内容」和「菜单和窗口动画」。")]),t._v(" "),a("li",[t._v("可以携带一条有线耳机插入主机的前端耳机插口（通常为绿色），以在远程桌面中使从服务端获取音频（听歌）。注意每次连接的时候远端设备音量会被设置为 100。")]),t._v(" "),a("li",[t._v("使用完成后，在关闭远程桌面之外，最好手动关机/重启公用电脑。即使登出了公用电脑（恢复输入学号/密码界面），远程桌面的连接信息（IP，用户名）依然会保存在远程桌面应用中，存在泄露个人信息的可能。")]),t._v(" "),a("li",[t._v("可以安装一个其他远程桌面软件（笔者自己使用 ToDesk）备用，以防因网络波动导致服务端 IP 改变无法连接。")])]),t._v(" "),a("blockquote",[a("p",[t._v("注：在图书馆如果不想远程桌面，但是却想用公用电脑的屏幕，可以携带一根 HDMI 转 DVI 转接线。三个图书馆的公用电脑的屏幕的接口均为 VGA + DVI，其中 VGA 接口连接主机，DVI 接口未连接。不建议为了使用屏幕而手动拔开连接主机的 VGA 线，这回为图书馆的维护人员带来困扰。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);